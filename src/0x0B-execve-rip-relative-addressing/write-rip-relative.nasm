; EXECVE
;   RDX     = 0x00
;   RSI     = 0x00
;   RDI     = address of '/bin/sh', 0xa
;   (RAX)SYSCALL = 0x3b

; WRITE
;   RSI     = 'hello world' address
;   RDI     = 0x01
;   RDX     = string length
;   (RAX)SYSCALL = 0x01

; EXIT
;   RDI     = 0x00
;   RDX     = string length
;   (RAX)SYSCALL = 0x3c

global _start

section .text

    _start:
    jmp _real_start
    ; the string needs to be placed before the code using it
    ; because this will make the relative jump a negative number
    ; avoiding nullbytes in the shellcode
    hello_world: db 'Hello world!', 0x0a

    _real_start:
    xor rdi, rdi
    mov rax, rdi
    mov rdx, rdi

    inc rdi
    add rdx, 13
    inc rax
    lea rsi, [rel hello_world]

    syscall

    
    
    




